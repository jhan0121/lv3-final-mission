# lv3-final-mission

## 레벨 3 최종 미션 인프라 구조

### 이전 미션에서 변경된 spring 서버 구조

우선 기존 미션에서 인프라 배포를 위한 수정 사항을 반영하였습니다.

- H2 -> mysql 마이그레이션 수행

H2 데이터베이스에서 mysql을 사용하도록 코드 설정 및 구조를 변경하였습니다. 변경을 고려하게 된 계기로, H2의 경우에는 "인메모리 DB"로 서버를 종료한다면 저장된 데이터가 모두 삭제된다는 문제가 있기
떄문이었습니다. 반면에 mysql은 사용자의 데이터를 영구적으로 저장할 수 있고,

- flyway 마이그레이션 툴 적용

flyway 마이그레이션 툴을 적용하였습니다. db에는 사용자의 데이터가 보관되기 때문에 스키마 구조를 변경하거나 사용자 데이터를 수정/삭제하는 쿼리를 작성하는 것을 JPA DDL AUTO 기능과 같이 자동화 기술에
의존하기에는 리스크가 너무 크다고 생각하였습니다. 따라서 개발자가 스스로 쿼리를 작성하면서 검증하는 과정을 수행하고, 사용자의 데이터를 최대한 보존할 수 있는 절차를 고안하여 쿼리를 작성/도입 하는데 도움을 주는
라이브러리인 flyway를 도입하는 것을 고려하였습니다. 이를 통해 "사용자 데이터"를 보호하는 방법을 강제할 수 있어 시스템 안정성을 높일 수 있었습니다.

- github actions를 통한 ci/cd 작업 수행

github actions를 활용하여 ci/cd 과정을 자동화 하였습니다. 안정적이고 지속적인 통합 과정을 보장해줄 수 있는 ci 스크립트와 배포 과정을 자동화 함으로써 빠르고 지속적인 배포를 수행할 수 있는 cd
스크립트를 자동화 하여 개발 프로세스를 간소화할 수 있는 기반을 마련할 수 있었습니다. 특히, ci 스크립트가 실패하면 pr을 close하여 잘못된 통합을 수행하지 못하도록 방지할 수 있었고 알림을 보내주어
실패하였음을 빠르게 확인할 수 있도록 구성하였습니다. cd 스크립트에서는 docker 컨테이너가 실행된 것으로 그치지 않고 컨테이너 내부의 spring 서버 정상 실행 여부도 확인하는 과정을 통해 자 상세한 실행
성공 여부를 확인할 수 있도록 구성하였습니다.

### 개발 환경 인프라 구조 및 배포 과정

개발 환경은 단일 EC2에서 docker compose를 활용하여 spring 서버 컨테이너와 mysql db 컨테이너 2개를 구성하도록 스크립트를 작성하였습니다. 개발 환경의 특성으로 "기능 로직이 자주 변경되고
사용자가 없기
때문에 많은 데이터를 저장하는 일이 많지 않을 것"이라고 생각하여 단일 EC2를 통한 빠르고 간편한 배포 과정을 구축할 수 있다는 더 큰 메리트가 존재한다고 생각하였습니다.

### 배포 환경 인프라 구조 및 배포 과정

배포 환경은 개발 환경과 달리, aws rds를 활용하여 별도의 DB 인스턴스를 구성하였습니다. 개발 환경과 같은 단일 EC2 인스턴스에 spring과 db를 모두 실행하게 된다면 관리가 간편하다는 장점이 있지만,
배포 환경의 주요 특징인 "지속적으로 사용자의 데이터가 보관되고 안정적이어야 한다."는 점이라고 생각하였기 때문에 단일 EC2로 관리하게 된다면 추후 사용자가 늘어 확장을 고려해야 할 때, EC2의 규모를 키우는
정도의 확장성만을 가지게 된다는 단점이 있습니다. 반면에 spring 서버 인스턴스와 db 인스턴스를 분리한다면 관리 포인트가 증가할 수 있지만, "특정 시점으로 복원"이나 추후에 확장성을 위해 고려할 수 있는
읽기/쓰기 부하 분산을 위한 "읽기 전용 복제본 생성"이나 무중단 배포를 위한 "블루-그린 배포 생성"과 같은 aws rds의 강력한 기능들을 활용하는 것으로 더 빠르고 효율적인 구조 개선 작업을 수행할 수 있을
것이라고 생각하여 적용하였습니다.
